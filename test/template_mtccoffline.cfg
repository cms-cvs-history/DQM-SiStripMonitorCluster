# template file to be used for MTCC data, the script substitutes the list of files and similar
  process SISTRIPDQMDIGISCLUSTERS = {
  
    # MessageLogger
    include "FWCore/MessageLogger/data/MessageLogger.cfi"
  #  include "DQM/SiStripCommon/data/MessageLogger.cfi"
  
    # magnetic field
  #  include "MagneticField/Engine/data/volumeBasedMagneticField.cfi"
  
    # geometry (switched to tracker only geometry)
  #  include "Geometry/CMSCommonData/data/cmsIdealGeometryXML.cfi"
  
    # tracker geometry
  #  include "Geometry/TrackerGeometryBuilder/data/trackerGeometry.cfi"
  
    #
  #  es_module = TrackerGeometricDetESModule {}
  
  
    # tracer service - very verbose - useful for debugging only
  #  service = Tracer { untracked string indention = "$$"}
  
    # source of simulated hits
  #  source = DQMSafePoolSource
  
  
    source = PoolSource
    {
     untracked vstring fileNames = {
              SCRIPT_LIST_OF_FILES
     }
     untracked int32 maxEvents = -1
     untracked uint32 debugVebosity = 1
     untracked bool   debugFlag     = true
    }
  
  #include "IORawData/SiStripInputSources/data/TBRUInputSource.cfi"
  #replace TBRUInputSource.fileNames = { "file:/afs/cern.ch/cms/cmt/onlinedev/data/RU0030349_000.root" }
  #replace	TBRUInputSource.maxEvents = -1
  
  # SiStripDigitizer
  #  include "SimTracker/SiStripDigitizer/data/SiStripDigi.cfi"
  
  # SiStripRaw2digi
  include "EventFilter/SiStripRawToDigi/data/RawToDigi.cfi"
  #replace RawToDigi.TriggerFedId = 53
  
  # ZeroSuppressor
  include "RecoLocalTracker/SiStripZeroSuppression/data/SiStripZeroSuppression.cfi"
  
  # include SiStripClusterizer
  include "RecoLocalTracker/SiStripClusterizer/data/SiStripClusterizer_RealData.cfi"
  #replace ThreeThresholdClusterizer.ChannelThreshold    = 1.0
  #replace ThreeThresholdClusterizer.SeedThreshold       = 2.0
  #replace ThreeThresholdClusterizer.ClusterThreshold    = 4.0
  
  #read cabling from db
  include "OnlineDB/SiStripESSources/data/BuildFedCablingUsingConfigDb.cfi"
  replace BuildFedCablingUsingConfigDb.UsingDb = true
  replace BuildFedCablingUsingConfigDb.User = "cms_mtcc_sitracker"
  replace BuildFedCablingUsingConfigDb.Passwd = "cms_mtcc"
  replace BuildFedCablingUsingConfigDb.Path = "omds"
  #replace BuildFedCablingUsingConfigDb.Partition = "MTCC_DEMO"
  replace BuildFedCablingUsingConfigDb.Partition = "MTCC_TESTCI_NEW"
  
  #read in pedestals
  es_source = PoolDBESSource { 
                VPSet toGet = {
                  { string record = "SiStripPedestalsRcd"
                    string tag = "SiStripPedestals_v1"
                  }
                 ,{ string record = "SiStripNoisesRcd"
                    string tag = "SiStripNoises_v1"
                  } 
                }
                bool loadAll = true
                string connect = "sqlite_file:insert_SiStripPedNoisesDB"
  	      untracked string catalog = "file:insert_SiStripPedNoisesCatalog" 
                string timetype = "runnumber" 
                untracked bool loadBlobStreamer = true
  
  	      untracked uint32 authenticationMethod = 0
                untracked uint32 messagelevel = 3
              }
  
      # produce SiStripFecCabling and SiStripDetCabling out of SiStripFedCabling
      es_module sistripconn = SiStripConnectivity {}
  
      # DQM services
      service = DaqMonitorROOTBackEnd{}
  
      # can comment out MonitorDeamon if you want to run without DQMCollector - this should go as include in DQMServices
  #    include "DQM/SiStripMonitorCluster/data/MonitorDaemon.cfi"
  #    replace MonitorDaemon.DestinationAddress = "lxcmse1.cern.ch"
  
      # SiStripMonitorDigi
      include "DQM/SiStripMonitorDigi/data/SiStripMonitorDigi_RealData.cfi"
      # use the following flag to select all detectors (e.g. for mtcc data). by default is false
      replace SiStripMonitorDigi.SelectAllDetectors = true
         
      # SiStripMonitorCluster
      include "DQM/SiStripMonitorCluster/data/SiStripMonitorCluster.cfi"
      # use the following flag to select all detectors (e.g. for mtcc data). by default is false
      replace SiStripMonitorCluster.SelectAllDetectors = true
      # use following to utput all histograms in a file
      replace SiStripMonitorCluster.OutputMEsInRootFile = true
      replace SiStripMonitorCluster.OutputFileName= "SCRIPT_DQM_OUTPUT_FILE"
  
  # Trigger
       module trigger = MTCCHLTrigger
       {
         bool SelOnDigiCharge=false
         int32 ChargeThreshold=70
         string  ClusterProducer = "ThreeThresholdClusterizer"
       }
  
  # Trigger Monitoring, SiStripMonitorHLT
    include "DQM/SiStripMonitorCluster/data/SiStripMonitorHLT.cfi"
  
  #  module EventContentAnalyzer = EventContentAnalyzer {}
  
  # prescaler module
    module Prescaler = Prescaler{ int32 prescaleFactor = 1}
  
  module out = PoolOutputModule 
    { 
      untracked string fileName = "SCRIPT_POOL_OUTPUT_FILE"
      untracked vstring outputCommands = {
       "keep SiStripClusteredmDetSetVector_ThreeThresholdClusterizer_*_*"
      }
    }
  
  ################# Schedule
   # reconstruction
   path pdigitize_clusterize    = { RawToDigi,theSiStripZeroSuppression, ThreeThresholdClusterizer}
   #trigger, digi and cluster monitoring
   path trig                    = {trigger}
   path pdqm                    = {Prescaler,SiStripMonitorDigi,SiStripMonitorCluster}
   # monitor for every event the trigger decision
   path phltdqm                 = {SiStripMonitorHLT}
   #
   endpath e = {out} # save all events in pool file
  }
